<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Products — ONS Cookers</title>
  <meta name="description" content="All products" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
  <header class="sticky-header">
    <nav class="navbar">
      <div class="navbar-left">
        <div class="hamburger-menu"><i class="fa-solid fa-grip"></i></div>
        <a href="products.html" class="menu-link" style="margin-left:1rem;font-weight:600;color:#000;">Products</a>
      </div>
      <div class="navbar-center">
        <div class="logo"><a href="index.html">ONS Cookers</a></div>
      </div>
      <div class="navbar-right">
        <div class="header-icons">
          <a href="#" id="search-icon"><i class="fa-solid fa-magnifying-glass"></i></a>
          <a href="cart.html" class="cart-icon-container"><i class="fa-solid fa-cart-shopping"></i><span class="cart-count">0</span></a>
          <a href="#"><i class="fa-solid fa-user"></i></a>
        </div>
      </div>
    </nav>
    <div id="search-bar" class="search-bar">
      <input type="text" placeholder="Search for products..." id="search-input">
      <button id="close-search"><i class="fa-solid fa-times"></i></button>
    </div>
  </header>

  <main>
    <section style="padding:2rem;text-align:left;">
      <h1>All Products</h1>
      <p style="color:#555;margin-bottom:1rem;">Browse all Steelbird products. Click a product to open its product page.</p>
    </section>

    <section style="padding:2rem;">
      <div id="products-grid" class="product-grid"></div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="#">Products</a></li>
          <li><a href="about.html">About Us</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h3>Follow Us</h3>
        <div class="social-icons">
          <a href="#"><i class="fa-brands fa-facebook"></i></a>
          <a href="#"><i class="fa-brands fa-instagram"></i></a>
        </div>
      </div>
      <div class="footer-section">
        <h3>Contact</h3>
        <p>Email: info@onscookers.com</p>
      </div>
    </div>
    <div class="footer-bottom"><p>&copy; 2024 ONS Cookers. All Rights Reserved.</p></div>
  </footer>

  <button id="scroll-to-top"><i class="fa-solid fa-arrow-up"></i></button>

  <script src="main.js"></script>
  <script>
    (function(){
      // load products from categories/products.json and render a grid
      fetch('categories/products.json')
        .then(r => r.json())
        .then(products => {
          const grid = document.getElementById('products-grid');
          if(!grid) return;
          grid.innerHTML = '';
          products.forEach(p => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.dataset.id = p.id || '';
            const img = (p.images && p.images[0]) ? p.images[0] : 'assets/images/category-1.jpg';
            card.innerHTML = `
              <a href="categories/product-template.html?id=${encodeURIComponent(p.id)}"><img src="${img}" alt="${p.title || ''}"></a>
              <h3><a href="categories/product-template.html?id=${encodeURIComponent(p.id)}">${p.title || ''}</a></h3>
              <p>₹${p.price || 0}</p>
              <button class="btn-secondary">Add to Cart</button>
            `;
            grid.appendChild(card);
          });
        })
        .catch(err => { console.error('Failed to load products', err); });

      // delegate add-to-cart from grid
      document.addEventListener('click', function(e){
        if(e.target.classList.contains('btn-secondary') && e.target.closest('.product-card')){
          const card = e.target.closest('.product-card');
          const id = card.dataset.id;
          fetch('categories/products.json').then(r=>r.json()).then(products=>{
            const p = products.find(x=>x.id===id);
            if(!p) return alert('Product not found');
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existing = cart.find(i=>i.id===p.id);
            if(existing) existing.quantity++;
            else cart.push({ id:p.id, name:p.title, price:p.price, image:(p.images&&p.images[0])||'', quantity:1 });
            localStorage.setItem('cart', JSON.stringify(cart));
            const cartCount = document.querySelector('.cart-count'); if(cartCount) cartCount.textContent = cart.reduce((acc, i)=>acc+i.quantity,0);
            // silently update cart count
          });
        }
      });
    })();
  </script>
</body>
</html>