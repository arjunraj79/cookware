<!DOCTYPE html>
<html lang="en">
<head>
    <script src="/components/js/head.js"></script>
</head>
<body>
   <script src="/components/js/header.js"></script>

  <script src="/components/js/mobile-nav.js"></script>

  <style>
    :root {
      --dark-red: #db0000;
    }

    /* Category Grid - 2 Column Layout */
    .category-grid {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px 0;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .category-tile {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
      padding: 10px;
      transition: transform 0.2s ease;
    }

    .category-tile:hover {
      transform: scale(1.02);
    }

    .category-tile img {
      width: 160px;
      height: 130px;
      object-fit: contain;
      display: block;
      padding: 10px;
    }

    .category-tile .cat-name {
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: #000;
      text-decoration: none;
      display: inline-block;
      width: 160px;
      margin-top: 5px;
    }

    /* Product Grid - 2 Column Layout */
    .product-grid-hawkins {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px 0;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .product-tile {
      width: 180px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 auto;
      text-align: center;
    }

    .product-tile .product-img-wrap {
      position: relative;
      width: 160px;
      height: 160px;
    }

    .product-tile .product-img-wrap img {
      width: 160px;
      height: 160px;
      object-fit: contain;
      display: block;
      cursor: pointer;
    }

    .product-tile .product-info {
      width: 160px;
      text-align: center;
      margin-top: 9px;
    }

    .product-tile .product-name {
      color: var(--dark-red);
      font-size: 14px;
      font-weight: 600;
      display: block;
      text-decoration: none;
      font-family: 'Poppins', sans-serif;
    }

    .product-tile .product-name:hover {
      text-decoration: underline;
    }

    .product-tile .product-capacity {
      font-size: 12px;
      display: block;
      margin-bottom: 4px;
      color: #333;
    }

    .product-tile .price-wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .product-tile .price-original {
      font-size: 15px;
      color: #666;
      position: relative;
      display: inline-block;
    }

    .product-tile .price-original::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 50%;
      height: 2px;
      background: var(--dark-red);
      transform: rotate(-10deg);
    }

    .product-tile .price-final {
      font-size: 16px;
      font-weight: 600;
      color: #000;
    }

    .product-tile .sold-out-badge {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 600;
      border-radius: 4px;
    }

    /* Back Button */
    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      margin: 20px auto;
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 6px;
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      color: #333;
      transition: background 0.2s ease;
    }

    .back-btn:hover {
      background: #eee;
    }

    /* Page Header */
    .page-header {
      text-align: center;
      padding: 20px;
    }

    .page-header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 24px;
      color: #000;
      margin: 0 0 10px 0;
    }

    .page-header p {
      color: #555;
      font-size: 14px;
      margin: 0;
    }

    /* Breadcrumb */
    .breadcrumb {
      text-align: center;
      padding: 10px 20px;
      font-size: 14px;
      color: #666;
    }

    .breadcrumb a {
      color: var(--dark-red);
      text-decoration: none;
    }

    .breadcrumb a:hover {
      text-decoration: underline;
    }

    .breadcrumb span {
      margin: 0 8px;
    }

    @media (max-width: 500px) {
      .category-grid,
      .product-grid-hawkins {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        width: 95%;
      }

      .category-tile img {
        width: 120px;
        height: 100px;
      }

      .category-tile .cat-name {
        font-size: 12px;
        width: 120px;
      }

      .product-tile {
        width: 150px;
      }

      .product-tile .product-img-wrap,
      .product-tile .product-img-wrap img {
        width: 130px;
        height: 130px;
      }

      .product-tile .product-info {
        width: 130px;
      }

      .product-tile .product-name {
        font-size: 12px;
      }

      .product-tile .product-capacity {
        font-size: 11px;
      }

      .product-tile .price-original {
        font-size: 13px;
      }

      .product-tile .price-final {
        font-size: 14px;
      }
    }
  </style>

  <main>
    <div class="page-header">
      <h1 id="page-title">Pressure Cookers</h1>
      <p id="page-subtitle">Select a category to browse products</p>
    </div>

    <div class="breadcrumb" id="breadcrumb">
      <a href="/products.html">All Categories</a>
    </div>

    <!-- Category Grid (Level 1) -->
    <div id="category-view" class="category-grid">
      <!-- Categories will be rendered here -->
    </div>

    <!-- Product Grid (Level 2) -->
    <div id="product-view" class="product-grid-hawkins" style="display: none;">
      <!-- Products will be rendered here -->
    </div>
  </main>

  <footer>
    <script src="/components/js/footer.js"></script>
  </footer>

  <button id="scroll-to-top"><i class="fa-solid fa-arrow-up"></i></button>

  <script src="main.js"></script>
  <nav class="mobile-bottom-nav" aria-label="Mobile navigation">
    <div class="nav-row">
      <a href="#" class="mobile-menu"><i class="fa-solid fa-bars"></i><span>Menu</span></a>
      <a href="cart.html" class="mobile-cart"><i class="fa-solid fa-cart-shopping"></i><span>Cart</span></a>
      <a href="index.html" class="mobile-home"><i class="fa-solid fa-home"></i><span>Home</span></a>
            <a href="/login.html" class="mobile-login"><i class="fa-solid fa-user"></i><span>Profile</span></a>
    </div>
  </nav>
  <script>
    (function(){
      // Define product categories/series with images
      const categories = [
        { id: 'pexa', name: 'PEXA', image: 'assets/img/Product Images/Steelbird pexa 3 ltr.jpg', prefix: 'SBP', excludePrefix: ['SBPIB'] },
        { id: 'pexa-ib', name: 'PEXA Induction Base', image: 'assets/img/Product Images/Steelbird pexa Induction base 3 ltr.jpeg', prefix: 'SBPIB', excludePrefix: ['SBPIB1.5LB', 'SBPIB3LB', 'SBPIB5LB'] },
        { id: 'big-pexa', name: 'Big PEXA', image: 'assets/img/Product Images/Steelbird big pexa 10 ltr.jpeg', ids: ['SBP8L', 'SBP10L', 'SBP12L', 'SBP15L'] },
        { id: 'mexa', name: 'MEXA', image: 'assets/img/Product Images/Steelbird mexa 3.5 ltr.jpeg', prefix: 'SBM', excludePrefix: ['SBMIB', 'SBM2LB', 'SBM3.5LB', 'SBM4LB', 'SBM5.5LB', 'SBM6.5LB', 'SBM2LS', 'SBM3.5LS', 'SBM4LS', 'SBM5.5LS', 'SBM6.5LS'] },
        { id: 'mexa-ib', name: 'MEXA Induction Base', image: 'assets/img/Product Images/Steelbird mexa induction base 3.5 ltr.jpeg', prefix: 'SBMIB', excludePrefix: ['SBMIB2LB', 'SBMIB3.5LB', 'SBMIB4LB', 'SBMIB5.5LB', 'SBMIB6.5LB', 'SBMIB2LS', 'SBMIB3.5LS', 'SBMIB4LS', 'SBMIB5.5LS', 'SBMIB6.5LS'] },
        { id: 'pexa-black', name: 'PEXA Black IB', image: 'assets/img/Product Images/Steelbird pexa black ib black lid 3ltr.jpeg', ids: ['SBPIB1.5LB', 'SBPIB3LB', 'SBPIB5LB'] },
        { id: 'mexa-black', name: 'MEXA Black', image: 'assets/img/Product Images/Steelbird mexa black ib with black lid 3.5 ltr.jpeg', ids: ['SBM2LB', 'SBM3.5LB', 'SBM4LB', 'SBM5.5LB', 'SBM6.5LB'] },
        { id: 'mexa-black-ib', name: 'MEXA Black IB', image: 'assets/img/Product Images/Steelbird mexa black ib with black lid 3.5 ltr.jpeg', ids: ['SBMIB2LB', 'SBMIB3.5LB', 'SBMIB4LB', 'SBMIB5.5LB', 'SBMIB6.5LB'] },
        { id: 'mexa-ss-lid', name: 'MEXA Black with SS Lid', image: 'assets/img/Product Images/Steelbird mexa black with ss lid 3.5 ltr.jpeg', ids: ['SBM2LS', 'SBM3.5LS', 'SBM4LS', 'SBM5.5LS', 'SBM6.5LS'] },
        { id: 'mexa-ib-ss-lid', name: 'MEXA Black IB with SS Lid', image: 'assets/img/Product Images/Steelbird mexa black ib with ss lid 3.5 ltr.jpeg', ids: ['SBMIB2LS', 'SBMIB3.5LS', 'SBMIB4LS', 'SBMIB5.5LS', 'SBMIB6.5LS'] }
      ];

      let allProducts = [];
      const urlParams = new URLSearchParams(window.location.search);
      const selectedCat = urlParams.get('cat');

      // Extract capacity from product title (e.g., "3L" from "Steelbird PEXA 3L")
      function extractCapacity(title) {
        const match = title.match(/(\d+\.?\d*)\s*L/i);
        if (match) {
          const liters = match[1];
          return liters + ' Litre';
        }
        return '';
      }

      // Calculate original price (10% higher than current price for display)
      function getOriginalPrice(price) {
        return Math.round(price * 1.1);
      }

      // Filter products by category
      function filterByCategory(products, category) {
        return products.filter(p => {
          if (category.ids) {
            return category.ids.includes(p.id);
          }
          if (category.prefix) {
            const matchesPrefix = p.id.startsWith(category.prefix);
            const isExcluded = category.excludePrefix && category.excludePrefix.some(ex => p.id.startsWith(ex) || p.id === ex);
            return matchesPrefix && !isExcluded;
          }
          return false;
        });
      }

      // Render category tiles (Level 1)
      function renderCategories() {
        const categoryView = document.getElementById('category-view');
        const productView = document.getElementById('product-view');
        const pageTitle = document.getElementById('page-title');
        const pageSubtitle = document.getElementById('page-subtitle');
        const breadcrumb = document.getElementById('breadcrumb');

        categoryView.style.display = 'grid';
        productView.style.display = 'none';
        pageTitle.textContent = 'Pressure Cookers';
        pageSubtitle.textContent = 'Select a category to browse products';
        breadcrumb.innerHTML = '<a href="/products.html">All Categories</a>';

        categoryView.innerHTML = categories.map(cat => `
          <div class="category-tile" data-cat="${cat.id}">
            <img src="${cat.image}" alt="${cat.name}" onerror="this.src='assets/img/Product Images/default.png'">
            <span class="cat-name">${cat.name}</span>
          </div>
        `).join('');

        // Add click handlers
        categoryView.querySelectorAll('.category-tile').forEach(tile => {
          tile.addEventListener('click', function() {
            const catId = this.dataset.cat;
            window.history.pushState({}, '', `?cat=${catId}`);
            renderProducts(catId);
          });
        });
      }

      // Render products (Level 2)
      function renderProducts(catId) {
        const categoryView = document.getElementById('category-view');
        const productView = document.getElementById('product-view');
        const pageTitle = document.getElementById('page-title');
        const pageSubtitle = document.getElementById('page-subtitle');
        const breadcrumb = document.getElementById('breadcrumb');

        const category = categories.find(c => c.id === catId);
        if (!category) {
          renderCategories();
          return;
        }

        const filteredProducts = filterByCategory(allProducts, category);

        categoryView.style.display = 'none';
        productView.style.display = 'grid';
        pageTitle.textContent = category.name;
        pageSubtitle.textContent = `${filteredProducts.length} products available`;
        breadcrumb.innerHTML = `
          <a href="/products.html">All Categories</a>
          <span>›</span>
          <span style="color: #000;">${category.name}</span>
        `;

        if (filteredProducts.length === 0) {
          productView.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #666;">No products found in this category.</p>';
          return;
        }

        productView.innerHTML = filteredProducts.map(p => {
          const img = (p.images && p.images[0]) ? p.images[0] : 'assets/img/Product Images/default.png';
          const capacity = extractCapacity(p.title);
          const originalPrice = getOriginalPrice(p.price);
          const productName = p.title.replace(/Steelbird\s*/i, '').trim();

          return `
            <div class="product-tile">
              <div class="product-img-wrap">
                <a href="categories/product-template.html?id=${encodeURIComponent(p.id)}">
                  <img src="${img}" alt="${p.title}" onerror="this.src='assets/img/Product Images/default.png'">
                </a>
              </div>
              <div class="product-info">
                <a href="categories/product-template.html?id=${encodeURIComponent(p.id)}" class="product-name">${productName}</a>
                ${capacity ? `<span class="product-capacity">${capacity}</span>` : ''}
                <div class="price-wrap">
                  <span style="font-size: 14px;">₹</span>
                  <span class="price-original">${originalPrice}</span>
                  <span class="price-final">${p.price}</span>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      // Handle browser back/forward
      window.addEventListener('popstate', function() {
        const params = new URLSearchParams(window.location.search);
        const cat = params.get('cat');
        if (cat) {
          renderProducts(cat);
        } else {
          renderCategories();
        }
      });

      // Load products and initialize
      fetch('categories/products.json')
        .then(r => r.json())
        .then(products => {
          allProducts = products;
          
          if (selectedCat) {
            renderProducts(selectedCat);
          } else {
            renderCategories();
          }
        })
        .catch(err => {
          console.error('Failed to load products', err);
          document.getElementById('category-view').innerHTML = '<p style="text-align: center; color: #666;">Failed to load products. Please try again.</p>';
        });
    })();
  </script>
</body>
</html>